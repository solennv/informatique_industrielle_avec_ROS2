

<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Formatter automatiquement la documentation RestructuredText (RST) &mdash; Documentation Cours d&#39;Informatique Industrielle avec ROS2 1.0.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=fdcf8bf8" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=05dadb3a"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=30646c52"></script>
      <script src="../_static/translations.js?v=e6b791cb"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="L’outil pre-commit" href="p04s10_precommit.html" />
    <link rel="prev" title="Formater automatiquement le code" href="p04s01_format_your_code.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Cours d'Informatique Industrielle avec ROS2
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Informatique Industrielle &amp; ROS2</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../c00_introduction/p00s00_index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../c01_create_and_publish_doc/p01s00_index.html">Premier projet &amp; doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../c02_first_ros2_project_pimped/p02s00_index.html">Tutoriel ROS2 épicé</a></li>
<li class="toctree-l1"><a class="reference internal" href="../c03_test_your_code/p03s00_index.html">Tester le code</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="p04s00_index.html">Les outils nécessaires pour collaborer entre codeurs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="p04s01_format_your_code.html">Formater automatiquement le code</a></li>
<li class="toctree-l2"><a class="reference internal" href="p04s01_format_your_code.html#conventions-de-codage">Conventions de codage</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Formatter automatiquement la documentation RestructuredText (RST)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">restructuredtext-lint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installation-de-restructuredtext-lint">Installation de restructuredtext-lint</a></li>
<li class="toctree-l4"><a class="reference internal" href="#utilisation-de-restructuredtext-lint">Utilisation de restructuredtext-lint</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id2">rstfmt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installation-de-rstfmt">Installation de rstfmt</a></li>
<li class="toctree-l4"><a class="reference internal" href="#utilisation-de-rstfmt-en-ligne-de-commande">Utilisation de rstfmt en ligne de commande</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#utilisation-dans-l-editeur-de-code">Utilisation dans l’éditeur de code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#visualisation-directe">Visualisation directe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#visualisation-minimap">Visualisation minimap</a></li>
<li class="toctree-l4"><a class="reference internal" href="#visualisation-dans-la-vue-problems">Visualisation dans la vue <code class="docutils literal notranslate"><span class="pre">Problems</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="p04s10_precommit.html">L’outil pre-commit</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Travaux Pratiques</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../p00_pentograph_pencil_holder_with_rpi_and_dynamixel/p50s00_index.html">Pantographe de dessin robotisé avec Raspberry Pi et ROS2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../p01_rpi_ubuntu_as_a_ros2_robotic_platform/p51s00_index.html">Ubuntu &amp; RPi &amp; ROS2</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Cours d'Informatique Industrielle avec ROS2</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="p04s00_index.html">Les outils nécessaires pour collaborer entre codeurs</a></li>
      <li class="breadcrumb-item active">Formatter automatiquement la documentation RestructuredText (RST)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/c04_collaborate_with_coders/p04s02_format_rst.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="formatter-automatiquement-la-documentation-restructuredtext-rst">
<h1>Formatter automatiquement la documentation RestructuredText (RST)<a class="headerlink" href="#formatter-automatiquement-la-documentation-restructuredtext-rst" title="Lien vers cette rubrique"></a></h1>
<p>Pour vérifier l’écriture de fichiers RST, il est possible d’utiliser des linters</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><a class="reference external" href="https://github.com/twolfson/restructuredtext-lint">restructuredtext-lint</a> qui ne permet que de
vérifier la syntaxe RST, mais donc permet d’afficher les erreurs de syntaxe RST directement dans
l’éditeur de code.</p></li>
<li><p><a class="reference external" href="https://github.com/dzhu/rstfmt">rstfmt</a> qui permet de vérifier la syntaxe RST de sphinx ET de
formatter automatiquement le code RST.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/LilSpazJoekp/docstrfmt">docstrfmt</a> est un fork récent à surveiller.</p></li>
</ul>
</li>
</ol>
</div></blockquote>
<section id="id1">
<h2>restructuredtext-lint<a class="headerlink" href="#id1" title="Lien vers cette rubrique"></a></h2>
<section id="installation-de-restructuredtext-lint">
<h3>Installation de restructuredtext-lint<a class="headerlink" href="#installation-de-restructuredtext-lint" title="Lien vers cette rubrique"></a></h3>
<p>Activer l’environnement virtuel et installer le linter avec la commande suivante depuis le dossier sphinx
du projet:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/info_indus/info_indus_tutorial/doc/sphinx
<span class="nb">source</span><span class="w"> </span>.venv/bin/activate
pip<span class="w"> </span>install<span class="w"> </span>restructuredtext-lint
</pre></div>
</div>
</section>
<section id="utilisation-de-restructuredtext-lint">
<h3>Utilisation de restructuredtext-lint<a class="headerlink" href="#utilisation-de-restructuredtext-lint" title="Lien vers cette rubrique"></a></h3>
<p>Pour vérifier un fichier RST (dont le nom est <cite>bad_format_rst_file.rst</cite>), il suffit de lancer la commande
suivante:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rst-lint<span class="w"> </span>bad_format_rst_file.rst
</pre></div>
</div>
<p>Si le fichier contient le code rst ci-dessous:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">code-block</span><span class="p">::</span> python
   import math as m
   print(m.pi)
</pre></div>
</div>
<p>Le linter renvoie les erreurs suivantes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ERROR</span> <span class="n">bad_format_rst_file</span><span class="o">.</span><span class="n">rst</span><span class="p">:</span><span class="mi">1</span> <span class="n">Error</span> <span class="ow">in</span> <span class="s2">&quot;code-block&quot;</span> <span class="n">directive</span><span class="p">:</span>
<span class="n">maximum</span> <span class="mi">1</span> <span class="n">argument</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">allowed</span><span class="p">,</span> <span class="mi">6</span> <span class="n">supplied</span><span class="o">.</span>
</pre></div>
</div>
<section id="explications">
<h4>Explications<a class="headerlink" href="#explications" title="Lien vers cette rubrique"></a></h4>
<p>Il manque, par exemple, un saut de ligne après la directive <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">code-block</span></code> et la ligne python
<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">math</span> <span class="pre">as</span> <span class="pre">m</span></code> est comprise comme un paramètre de la directive <code class="docutils literal notranslate"><span class="pre">code-block</span></code> et est donc mal
interprétée.</p>
</section>
</section>
</section>
<section id="id2">
<h2>rstfmt<a class="headerlink" href="#id2" title="Lien vers cette rubrique"></a></h2>
<section id="installation-de-rstfmt">
<h3>Installation de rstfmt<a class="headerlink" href="#installation-de-rstfmt" title="Lien vers cette rubrique"></a></h3>
<p>Activer l’environnement virtuel et installer le linter avec la commande suivante depuis le dossier sphinx du
projet:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/info_indus/info_indus_tutorial/doc/sphinx
<span class="nb">source</span><span class="w"> </span>.venv/bin/activate
pip<span class="w"> </span>install<span class="w"> </span>rstfmt
</pre></div>
</div>
</section>
<section id="utilisation-de-rstfmt-en-ligne-de-commande">
<h3>Utilisation de rstfmt en ligne de commande<a class="headerlink" href="#utilisation-de-rstfmt-en-ligne-de-commande" title="Lien vers cette rubrique"></a></h3>
<p>Pour visualiser les erreurs de formatage d’un fichier RST (dont le nom est <cite>bad_format_rst_file.rst</cite>),
il suffit de lancer la commande suivante:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rstfmt<span class="w"> </span>--diff<span class="w"> </span>&lt;file&gt;
</pre></div>
</div>
<p>Le résultat apparaîtra dans le terminal sous le format d’un fichier diff (comme avec git).
Pour sauvegarder le résultat dans un fichier, il suffit de rediriger la sortie standard vers un fichier:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rstfmt<span class="w"> </span>--diff<span class="w"> </span>&lt;file&gt;<span class="w"> </span>&gt;<span class="w"> </span>&lt;output_file&gt;
</pre></div>
</div>
<p>Pour formatter un fichier RST <code class="docutils literal notranslate"><span class="pre">en</span> <span class="pre">place</span></code> (dont le nom est <cite>bad_format_rst_file.rst</cite>), il suffit de lancer la commande suivante:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rstfmt<span class="w"> </span>bad_format_rst_file.rst
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ATTENTION:</span></code> le fichier est modifié directement.</p>
</section>
</section>
<section id="utilisation-dans-l-editeur-de-code">
<h2>Utilisation dans l’éditeur de code<a class="headerlink" href="#utilisation-dans-l-editeur-de-code" title="Lien vers cette rubrique"></a></h2>
<section id="visualisation-directe">
<h3>Visualisation directe<a class="headerlink" href="#visualisation-directe" title="Lien vers cette rubrique"></a></h3>
<p>Il est possible d’utiliser le linter directement dans l’éditeur de code. Par exemple, dans vscode, il est possible d’installer l’extension <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=lextudio.restructuredtext">reStructuredText</a> qui permet de vérifier la syntaxe RST directement dans l’éditeur.</p>
<p>Les erreurs sont alors affichées directement dans l’éditeur de code qui souligne les erreurs avec des vagues comme dans l’image ci-dessous:</p>
<figure class="align-center">
<img alt="../_images/vscode_rst_linter_00.png" src="../_images/vscode_rst_linter_00.png" />
</figure>
<p>En passant la souris sur la partie soulignée, une bulle d’information apparaît avec le message d’erreur et de la documentation sur la commande utilisée.
L’erreur rapportée n’est pas toujours pertinente, et il est souvent très instructif de parcourir la documentation et en particulier de scruter les exemples fournis.</p>
<p>La limite de cette visualisation c’est qu’il faut avoir le fichier ouvert à l’emplacement d’une erreur dans l’éditeur pour voir l’erreur.</p>
</section>
<section id="visualisation-minimap">
<h3>Visualisation minimap<a class="headerlink" href="#visualisation-minimap" title="Lien vers cette rubrique"></a></h3>
<p>Les erreurs apparaissent également comme des lignes en rouge dans la vue latérale <code class="docutils literal notranslate"><span class="pre">minimap</span></code> de vscode qui donne une vue d’ensemble du fichier. On peut activer cette vue en faisant un clic droit sur la barre de scrolling du fichier (à droite) et en checkant <code class="docutils literal notranslate"><span class="pre">Minimap</span></code>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/vscode_rst_linter_01.png"><img alt="../_images/vscode_rst_linter_01.png" src="../_images/vscode_rst_linter_01.png" style="height: 200px;" />
</a>
</figure>
</section>
<section id="visualisation-dans-la-vue-problems">
<h3>Visualisation dans la vue <code class="docutils literal notranslate"><span class="pre">Problems</span></code><a class="headerlink" href="#visualisation-dans-la-vue-problems" title="Lien vers cette rubrique"></a></h3>
<p>Les erreurs sont également listées dans la vue <code class="docutils literal notranslate"><span class="pre">Problems</span></code> de vscode. On peut y accéder</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>en cliquant sur l’icône en forme de triangle dans la barre de status de vscode souvent située en bas à gauche de la fenêtre.</p></li>
<li><p>en ouvrant la vue de terminal en bas et sélectionnant l’onglet <code class="docutils literal notranslate"><span class="pre">Problems</span></code>.</p></li>
</ol>
</div></blockquote>
<figure class="align-center">
<img alt="../_images/vscode_rst_linter_02.png" src="../_images/vscode_rst_linter_02.png" />
</figure>
<p>C’est la vue la plus intéressante car toutes les erreurs de tous les fichiers sont listées, avec un lien clickable pour se rendre directement à l’endroit de l’erreur dans le fichier.</p>
<figure class="align-center">
<img alt="../_images/vscode_rst_linter_03.png" src="../_images/vscode_rst_linter_03.png" />
</figure>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="p04s01_format_your_code.html" class="btn btn-neutral float-left" title="Formater automatiquement le code" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="p04s10_precommit.html" class="btn btn-neutral float-right" title="L’outil pre-commit" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Manuel YGUEL.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>